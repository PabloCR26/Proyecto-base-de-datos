

--TABLAS

CREATE TABLE DIVISIONES(
    ID_DIVISION NUMBER CONSTRAINT PK_DIVISIONES PRIMARY KEY,
    NOMBRE_DIVISION VARCHAR(20) NOT NULL
)

CREATE TABLE NACIONALIDADES(
    ID_NACIONALIDAD NUMBER CONSTRAINT PK_NACIONADLIDAD PRIMARY KEY,
    DESCRIPCION VARCHAR(50) NOT NULL
)

CREATE TABLE ESTADIOS(
    ID_ESTADIO NUMBER CONSTRAINT PK_ESTADIOS PRIMARY KEY,
    NOMBRE_ESTADIO VARCHAR(200) NOT NULL,
    UBICACION VARCHAR(15) 
)

CREATE TABLE ARBITROS(
    ID_ARBITRO NUMBER CONSTRAINT PK_ARBITROS PRIMARY KEY,
    NOMBRE VARCHAR(20) NOT NULL ,
    APELLIDO1 VARCHAR(20) NOT NULL,
    APELLIDO2 VARCHAR(20),
    ID_NACIONALIDAD NUMBER,
    CONSTRAINT FK_ARBITRO_NACIONALIDAD FOREIGN KEY (ID_NACIONALIDAD) REFERENCES NACIONALIDADES (ID_NACIONALIDAD)
) 

CREATE TABLE ENTRENADORES(
    ID_ENTRENADOR NUMBER CONSTRAINT PK_ENTRENDOR PRIMARY KEY,
    NOMBRE VARCHAR(20) NOT NULL,
    APELLIDO1 VARCHAR(20) NOT NULL,
    APELLIDO2 VARCHAR(20),
    ID_NACIONALIDAD NUMBER,
    CONSTRAINT FK_ENTRENADOR_NACIONALIDAD FOREIGN KEY (ID_NACIONALIDAD) REFERENCES NACIONALIDADES (ID_NACIONALIDAD)
)

CREATE TABLE JUGADORES(
    ID_JUGADOR NUMBER CONSTRAINT PK_JUGADOR PRIMARY KEY,
    NOMBRE VARCHAR(20) NOT NULL,
    APELLIDO1 VARCHAR(15) NOT NULL,
    APELLIDO2 VARCHAR(15),
    ID_NACIONALIDAD NUMBER NOT NULL,
    CONSTRAINT FK_JUGADOR_NACIONALIDAD FOREIGN KEY (ID_NACIONALIDAD) REFERENCES NACIONALIDADES(ID_NACIONALIDAD)
)

CREATE TABLE EQUIPOS(
    ID_EQUIPO NUMBER CONSTRAINT PK_EQUIPOS PRIMARY KEY,
    NOMBRE_EQUIPO VARCHAR(20) NOT NULL,
    FECHA_FUNDACION DATE,
    ID_ENTRENADOR NUMBER,
    ID_DIVISION NUMBER,
    ID_ESTADIO NUMBER,
    CONSTRAINT FK_EQUIPO_ENTRENADOR FOREIGN KEY (ID_ENTRENADOR) REFERENCES ENTRENADORES (ID_ENTRENADOR),
    CONSTRAINT FK_EQUIPO_DIVISION FOREIGN KEY (ID_DIVISION) REFERENCES DIVISIONES (ID_DIVISION),
    CONSTRAINT FK_EQUIPO_ESTADIO FOREIGN KEY (ID_ESTADIO) REFERENCES ESTADIOS (ID_ESTADIO),
    CONSTRAINT UK_EQUIPO_NOMBRE UNIQUE (NOMBRE_EQUIPO),
    CONSTRAINT UK_EQUIPO_ENTRENADOR UNIQUE (ID_ENTRENADOR)
)

CREATE TABLE PARTIDOS(
    ID_PARTIDO NUMBER CONSTRAINT PK_PARTIDOS PRIMARY KEY,
    ID_ESTADIO NUMBER NOT NULL,
    ID_ARBITRO NUMBER NOT NULL,
    ID_EQUIPO_LOCAL NUMBER NOT NULL,
    GOLES_LOCAL NUMBER,
    ID_EQUIPO_VISITA NUMBER,
    GOLES_VISITA NUMBER,
    CONSTRAINT FK_PARTIDO_ESTADIO FOREIGN KEY (ID_ESTADIO) REFERENCES ESTADIOS (ID_ESTADIO),
    CONSTRAINT FK_PARTIDO_ARBITRO FOREIGN KEY (ID_ARBITRO) REFERENCES ARBITROS (ID_ARBITRO),
    CONSTRAINT FK_PARTIDO_EQUIPO_LOCAL FOREIGN KEY (ID_EQUIPO_LOCAL) REFERENCES EQUIPOS (ID_EQUIPO),
    CONSTRAINT FK_PARTIDO_EQUIPO_VISITA FOREIGN KEY (ID_EQUIPO_VISITA) REFERENCES EQUIPOS (ID_EQUIPO)
)


CREATE TABLE TRANSFERENCIAS(
    ID_JUGADOR NUMBER,
    ID_EQUIPO_ANTERIOR NUMBER,
    ID_EQUIPO_NUEVO NUMBER,
    FECHA_TRANSFERENCIA DATE,
    TOTAL_TRANSFERENCIA NUMBER(8,2),
    CONSTRAINT FK_TRANS_JUGADOR FOREIGN KEY (ID_JUGADOR) REFERENCES JUGADORES (ID_JUGADOR),
    CONSTRAINT FK_TRANS_EQUIPO_NUEVO FOREIGN KEY (ID_EQUIPO_NUEVO) REFERENCES EQUIPOS (ID_EQUIPO),
    CONSTRAINT FK_TRANS_EQUIPO_ANTERIOR FOREIGN KEY (ID_EQUIPO_ANTERIOR) REFERENCES EQUIPOS (ID_EQUIPO)
)



------------------ TABLAS INTERMEDIAS -------------

CREATE TABLE EQUIPO_JUGADORES (
    ID_EQUIPO NUMBER,
    ID_JUGADOR NUMBER,
    CONSTRAINT FK_EQJU_EQUIPO FOREIGN KEY (ID_EQUIPO) REFERENCES EQUIPOS (ID_EQUIPO),
    CONSTRAINT FK_EQJU_JUGADOR FOREIGN KEY (ID_JUGADOR) REFERENCES JUGADORES (ID_JUGADOR)
)

CREATE TABLE CONVOCATORIA (
    ID_PARTIDO NUMBER,
    ID_JUGADOR NUMBER,
    CONSTRAINT FK_CONV_PARTIDO FOREIGN KEY (ID_PARTIDO) REFERENCES PARTIDOS (ID_PARTIDO),
    CONSTRAINT FK_CONV_JUGADOR FOREIGN KEY (ID_JUGADOR) REFERENCES JUGADORES (ID_JUGADOR)
)







-----------------------------INSERT  DE DATOS A TABLAS-----------------------------------------------------------------------------

---TABLA DIVISIONES

INSERT INTO  DIVISIONES (ID_DIVISION,NOMBRE_DIVISION)VALUES (1,'PRIMERA');
INSERT INTO  DIVISIONES (ID_DIVISION,NOMBRE_DIVISION)VALUES (2,'SEGUNDA');


--TABLA NACIONALIDADES

INSERT INTO  NACIONALIDADES (ID_NACIONALIDAD,DESCRIPCION)VALUES (1,'COSTARRICENSE');
INSERT INTO  NACIONALIDADES (ID_NACIONALIDAD,DESCRIPCION)VALUES (2,'CANADIENSE');
INSERT INTO NACIONALIDADES (ID_NACIONALIDAD,DESCRIPCION)VALUES (3,'PANAMEÑO');
INSERT INTO  NACIONALIDADES (ID_NACIONALIDAD,DESCRIPCION)VALUES (4,'CUBANO');
INSERT INTO  NACIONALIDADES (ID_NACIONALIDAD,DESCRIPCION)VALUES (5,'HONDUREÑO');
INSERT INTO  NACIONALIDADES (ID_NACIONALIDAD,DESCRIPCION)VALUES (6,'MEXICANO');
INSERT INTO  NACIONALIDADES (ID_NACIONALIDAD,DESCRIPCION)VALUES (7,'ARGENTINO');
INSERT INTO  NACIONALIDADES (ID_NACIONALIDAD,DESCRIPCION)VALUES (8,'BRASILEÑO');
INSERT INTO  NACIONALIDADES (ID_NACIONALIDAD,DESCRIPCION)VALUES (9,'JAMAIQUINO');
INSERT INTO  NACIONALIDADES (ID_NACIONALIDAD,DESCRIPCION)VALUES (10,'GUATEMALTECO');


---TABLA ESTADIOS
select * from estadios

INSERT INTO ESTADIOS(ID_ESTADIO,NOMBRE_ESTADIO,UBICACION) VALUES (1,'ALEJANDRO MORERA SOTO','ALAJUELA'); 
INSERT INTO ESTADIOS(ID_ESTADIO,NOMBRE_ESTADIO,UBICACION) VALUES (2,'RICARDO SAPRISSA AYMA','TIBAS'); 
INSERT INTO ESTADIOS(ID_ESTADIO,NOMBRE_ESTADIO,UBICACION) VALUES (3,'ROSABAL CORDERO','HEREDIA'); 
INSERT INTO ESTADIOS(ID_ESTADIO,NOMBRE_ESTADIO,UBICACION) VALUES (4,'CARLOS UGALDE ALVAREZ','SAN CARLOS'); 
INSERT INTO ESTADIOS(ID_ESTADIO,NOMBRE_ESTADIO,UBICACION) VALUES (5,'CHOROTEGA','GUANACASTE'); 
INSERT INTO ESTADIOS(ID_ESTADIO,NOMBRE_ESTADIO,UBICACION) VALUES (6,'ALLEN RIGGIONI','GRECIA'); 
INSERT INTO ESTADIOS(ID_ESTADIO,NOMBRE_ESTADIO,UBICACION) VALUES (7,'RAFAEL BOLAÑOS','ALAJUELA'); 
INSERT INTO ESTADIOS(ID_ESTADIO,NOMBRE_ESTADIO,UBICACION) VALUES (8,'PIEDEDADES DE SANTA ANA','SANTA ANA'); 
INSERT INTO ESTADIOS(ID_ESTADIO,NOMBRE_ESTADIO,UBICACION) VALUES (9,'ASOCIACION CIVICA JICARALEÑA','JICARAL');  
INSERT INTO ESTADIOS(ID_ESTADIO,NOMBRE_ESTADIO,UBICACION) VALUES (10,'JUAN GOBAN','LIMON'); 



---TABLA ARBITROS

INSERT INTO  ARBITROS (ID_ARBITRO,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (1,'RODRIGO0','BADILLA','QUESADA','1');
INSERT INTO  ARBITROS (ID_ARBITRO,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (2,'HENRY','BEJARANO','SOLIS','1');
INSERT INTO  ARBITROS (ID_ARBITRO,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (3,'JUAN','GABRIEL','CALDERON','UMAÑA','1');
INSERT INTO ARBITROS (ID_ARBITRO,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (4,'JEFFRY','SOLIS','CALDERON','1');
INSERT INTO  ARBITROS (ID_ARBITRO,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (5,'HUGO','CRUZ','ALVARADO','1');
INSERT INTO   ARBITROS (ID_ARBITRO,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (6,'KEYLOR','HERRERA','ROJAS','1');
INSERT INTO  ARBITROS (ID_ARBITRO,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (7,'DAVID','GOMEZ','PORRAS','1');
INSERT INTO  ARBITROS (ID_ARBITRO,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (8,'WILLIAM','MATTUS','LOPEZ','1');
INSERT INTO  ARBITROS (ID_ARBITRO,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (9,'BENJAMIN','PINEDA','ARAYA','1');
INSERT INTO  ARBITROS (ID_ARBITRO,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (10,'BERNY','ULLOA','RAMIREZ','1');



---TABLLA ENTRENADORES

INSERT INTO  ENTRENADORES (ID_ENTRENADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (1,'DUGLAS','SEQUEIRA','ALVARADO','1');
INSERT INTO   ENTRENADORES (ID_ENTRENADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (2,'GUSTAVO','MATOSAS','RAMIREZ','7');
INSERT INTO  ENTRENADORES (ID_ENTRENADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (3,'MARIO','GARCIA','CORDERO','6');
INSERT INTO ENTRENADORES (ID_ENTRENADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (4,'LUIS','MARIN','CHAVES','1');
INSERT INTO  ENTRENADORES (ID_ENTRENADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (5,'HORACIO','ESQUIVEL','OLLOA','1');
INSERT INTO  ENTRENADORES (ID_ENTRENADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (6,'VLADIMIR','QUESADA','ROJAS','1');
INSERT INTO ENTRENADORES (ID_ENTRENADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (7,'ALEXANDER','GUIMARAES','VELASQUEZ','1');
INSERT INTO  ENTRENADORES (ID_ENTRENADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (8,'JAVIER','SAN','ROMAN','6');
INSERT INTO  ENTRENADORES (ID_ENTRENADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (9,'GUILLHERME','ALMEIDA','FARINHA','8');
INSERT INTO  ENTRENADORES (ID_ENTRENADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (10,'ALFRED','ROJAS','FAKO','7');

----TABLLA JUGADORES


INSERT INTO  JUGADORES (ID_JUGADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (1,'KEVIN','CHAMORRO','BENAVIDEZ','1');
INSERT INTO  JUGADORES (ID_JUGADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (2,'ALEXIS','GAMBOA ','BOGANTES','1');
INSERT INTO  JUGADORES (ID_JUGADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (3,'FERNAN','FAERRON','ROJAS','1');
INSERT INTO  JUGADORES (ID_JUGADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (4,'JOEL','CAMPBELL','SOLIS','1');
INSERT INTO  JUGADORES (ID_JUGADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (5,'JESUS','GONINES','ROMAN','6');
INSERT INTO  JUGADORES (ID_JUGADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (6,'FREDDY','GONDOLA','FARINHA','3');
INSERT INTO  JUGADORES (ID_JUGADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (7,'MARCEL','HERNANDEZ','MONTERO','4');
INSERT INTO  JUGADORES (ID_JUGADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (8,'MARIANO','TORRES','FEREIRA','7');
INSERT INTO  JUGADORES (ID_JUGADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (9,'KENDALL','WATSON','CURT','1');
INSERT INTO  JUGADORES (ID_JUGADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (10,'JAVON','EAST','RATS','9');
INSERT INTO  JUGADORES (ID_JUGADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (11,'LUIS','PARADELA','ROMAN','4');
INSERT INTO  JUGADORES (ID_JUGADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (12,'EVERARDO','RUBIO','FAR','6');
INSERT INTO  JUGADORES (ID_JUGADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (13,'MIGUEL','BASULTO','ROCHA','6');
INSERT INTO  JUGADORES (ID_JUGADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (14,'MANJREKAR','JAMES','SMITH','2');
INSERT INTO  JUGADORES (ID_JUGADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (15,'FIDEL','ESCOBAR','RODRIGUEZ','3');
INSERT INTO  JUGADORES (ID_JUGADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (16,'DAVID','GUZAMAN','LOPEZ','1');
INSERT INTO  JUGADORES (ID_JUGADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (17,'ESTEBAN','ALVARADO','SOTO','1');
INSERT INTO  JUGADORES (ID_JUGADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (18,'MIGUEL','AJU','SET','1');
INSERT INTO  JUGADORES (ID_JUGADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (19,'YOSEL','PÍEDRA','POS','4');
INSERT INTO  JUGADORES (ID_JUGADOR,NOMBRE,APELLIDO1,APELLIDO2,ID_NACIONALIDAD)VALUES (20,'ALEJANDRO','CABRAL','FAIS','7');


---TABLA EQUIPOS

INSERT INTO  EQUIPOS (ID_EQUIPO,NOMBRE_EQUIPO,FECHA_FUNDACION,ID_ENTRENADOR,ID_DIVISION,ID_ESTADIO)VALUES (1,'SAPRISSA','6/7/1935',6,1,2);
INSERT INTO  EQUIPOS (ID_EQUIPO,NOMBRE_EQUIPO,FECHA_FUNDACION,ID_ENTRENADOR,ID_DIVISION,ID_ESTADIO)VALUES (2,'LIGA','18/6/1919',7,1,1);
INSERT INTO  EQUIPOS (ID_EQUIPO,NOMBRE_EQUIPO,FECHA_FUNDACION,ID_ENTRENADOR,ID_DIVISION,ID_ESTADIO)VALUES (3,'SAN CARLOS','9/5/1965',4,1,4);
INSERT INTO  EQUIPOS (ID_EQUIPO,NOMBRE_EQUIPO,FECHA_FUNDACION,ID_ENTRENADOR,ID_DIVISION,ID_ESTADIO)VALUES (4,'GUANACASTECA','3/1/1973',5,1,5);
INSERT INTO  EQUIPOS (ID_EQUIPO,NOMBRE_EQUIPO,FECHA_FUNDACION,ID_ENTRENADOR,ID_DIVISION,ID_ESTADIO)VALUES (5,'HEREDIA','12/6/1921',1,1,3);
INSERT INTO  EQUIPOS (ID_EQUIPO,NOMBRE_EQUIPO,FECHA_FUNDACION,ID_ENTRENADOR,ID_DIVISION,ID_ESTADIO)VALUES (6,'GRECIA','16/8/1998',8,1,6);
INSERT INTO  EQUIPOS (ID_EQUIPO,NOMBRE_EQUIPO,FECHA_FUNDACION,ID_ENTRENADOR,ID_DIVISION,ID_ESTADIO)VALUES (7,'JICARAL','12/5/2007',2,2,9);
INSERT INTO  EQUIPOS (ID_EQUIPO,NOMBRE_EQUIPO,FECHA_FUNDACION,ID_ENTRENADOR,ID_DIVISION,ID_ESTADIO)VALUES (8,'CARMELTA','20/10/1948',9,2,7);
INSERT INTO  EQUIPOS (ID_EQUIPO,NOMBRE_EQUIPO,FECHA_FUNDACION,ID_ENTRENADOR,ID_DIVISION,ID_ESTADIO)VALUES (9,'LIMON','10/2/1999',3,2,10);
INSERT INTO  EQUIPOS (ID_EQUIPO,NOMBRE_EQUIPO,FECHA_FUNDACION,ID_ENTRENADOR,ID_DIVISION,ID_ESTADIO)VALUES (10,'SANTA ANA','15/5/1997',10,2,8);


---TABLA PARTIDOS

INSERT INTO  PARTIDOS (ID_PARTIDO,ID_ESTADIO,ID_ARBITRO,ID_EQUIPO_LOCAL,GOLES_LOCAL,ID_EQUIPO_VISITA,GOLES_VISITA)VALUES (1,1,2,2,2,1,2);
INSERT INTO  PARTIDOS (ID_PARTIDO,ID_ESTADIO,ID_ARBITRO,ID_EQUIPO_LOCAL,GOLES_LOCAL,ID_EQUIPO_VISITA,GOLES_VISITA)VALUES (2,2,1,3,3,5,2);
INSERT INTO  PARTIDOS (ID_PARTIDO,ID_ESTADIO,ID_ARBITRO,ID_EQUIPO_LOCAL,GOLES_LOCAL,ID_EQUIPO_VISITA,GOLES_VISITA)VALUES (3,4,3,3,2,4,1);
INSERT INTO  PARTIDOS (ID_PARTIDO,ID_ESTADIO,ID_ARBITRO,ID_EQUIPO_LOCAL,GOLES_LOCAL,ID_EQUIPO_VISITA,GOLES_VISITA)VALUES (4,6,4,6,1,1,1);
INSERT INTO  PARTIDOS (ID_PARTIDO,ID_ESTADIO,ID_ARBITRO,ID_EQUIPO_LOCAL,GOLES_LOCAL,ID_EQUIPO_VISITA,GOLES_VISITA)VALUES (5,7,5,8,0,7,2);
INSERT INTO  PARTIDOS (ID_PARTIDO,ID_ESTADIO,ID_ARBITRO,ID_EQUIPO_LOCAL,GOLES_LOCAL,ID_EQUIPO_VISITA,GOLES_VISITA)VALUES (6,8,6,10,2,7,1);
INSERT INTO  PARTIDOS (ID_PARTIDO,ID_ESTADIO,ID_ARBITRO,ID_EQUIPO_LOCAL,GOLES_LOCAL,ID_EQUIPO_VISITA,GOLES_VISITA)VALUES (7,10,7,10,3,8,3);
INSERT INTO  PARTIDOS (ID_PARTIDO,ID_ESTADIO,ID_ARBITRO,ID_EQUIPO_LOCAL,GOLES_LOCAL,ID_EQUIPO_VISITA,GOLES_VISITA)VALUES (8,3,8,5,3,6,1);
INSERT INTO  PARTIDOS (ID_PARTIDO,ID_ESTADIO,ID_ARBITRO,ID_EQUIPO_LOCAL,GOLES_LOCAL,ID_EQUIPO_VISITA,GOLES_VISITA)VALUES (9,9,9,7,6,10,4);
INSERT INTO  PARTIDOS (ID_PARTIDO,ID_ESTADIO,ID_ARBITRO,ID_EQUIPO_LOCAL,GOLES_LOCAL,ID_EQUIPO_VISITA,GOLES_VISITA)VALUES (10,5,10,4,2,2,2);





---TABLA TRANSFERENCIAS
INSERT INTO  TRANSFERENCIAS (ID_JUGADOR,ID_EQUIPO_ANTERIOR,ID_EQUIPO_NUEVO,FECHA_TRANSFERENCIA,TOTAL_TRANSFERENCIA)VALUES (1,8,1,'14/5/2017',300000);
INSERT INTO  TRANSFERENCIAS (ID_JUGADOR,ID_EQUIPO_ANTERIOR,ID_EQUIPO_NUEVO,FECHA_TRANSFERENCIA,TOTAL_TRANSFERENCIA)VALUES (20,1,3,'20/2/2024',500000);
INSERT INTO  TRANSFERENCIAS (ID_JUGADOR,ID_EQUIPO_ANTERIOR,ID_EQUIPO_NUEVO,FECHA_TRANSFERENCIA,TOTAL_TRANSFERENCIA)VALUES (6,5,2,'21/5/2022',100000);
INSERT INTO  TRANSFERENCIAS (ID_JUGADOR,ID_EQUIPO_ANTERIOR,ID_EQUIPO_NUEVO,FECHA_TRANSFERENCIA,TOTAL_TRANSFERENCIA)VALUES (18,2,4,'12/2/2020',200000);
INSERT INTO  TRANSFERENCIAS (ID_JUGADOR,ID_EQUIPO_ANTERIOR,ID_EQUIPO_NUEVO,FECHA_TRANSFERENCIA,TOTAL_TRANSFERENCIA)VALUES (9,9,1,'23/6/2018',400000);
INSERT INTO  TRANSFERENCIAS (ID_JUGADOR,ID_EQUIPO_ANTERIOR,ID_EQUIPO_NUEVO,FECHA_TRANSFERENCIA,TOTAL_TRANSFERENCIA)VALUES (16,1,10,'17/4/2024',600000);
INSERT INTO  TRANSFERENCIAS (ID_JUGADOR,ID_EQUIPO_ANTERIOR,ID_EQUIPO_NUEVO,FECHA_TRANSFERENCIA,TOTAL_TRANSFERENCIA)VALUES (3,2,5,'14/02/23',500000);





---TABLA EQUIPO_JUGADORES


INSERT INTO  EQUIPO_JUGADORES (ID_EQUIPO,ID_JUGADOR)VALUES (1,1);
INSERT INTO  EQUIPO_JUGADORES (ID_EQUIPO,ID_JUGADOR)VALUES (2,2);
INSERT INTO  EQUIPO_JUGADORES (ID_EQUIPO,ID_JUGADOR)VALUES (3,5);
INSERT INTO  EQUIPO_JUGADORES (ID_EQUIPO,ID_JUGADOR)VALUES (4,2);
INSERT INTO  EQUIPO_JUGADORES (ID_EQUIPO,ID_JUGADOR)VALUES (5,5);
INSERT INTO  EQUIPO_JUGADORES (ID_EQUIPO,ID_JUGADOR)VALUES (6,2);
INSERT INTO  EQUIPO_JUGADORES (ID_EQUIPO,ID_JUGADOR)VALUES (7,2);
INSERT INTO  EQUIPO_JUGADORES (ID_EQUIPO,ID_JUGADOR)VALUES (8,2);
INSERT INTO  EQUIPO_JUGADORES (ID_EQUIPO,ID_JUGADOR)VALUES (9,1);
INSERT INTO  EQUIPO_JUGADORES (ID_EQUIPO,ID_JUGADOR)VALUES (1,10);
INSERT INTO  EQUIPO_JUGADORES (ID_EQUIPO,ID_JUGADOR)VALUES (10,12);
INSERT INTO  EQUIPO_JUGADORES (ID_EQUIPO,ID_JUGADOR)VALUES (5,13);
INSERT INTO  EQUIPO_JUGADORES (ID_EQUIPO,ID_JUGADOR)VALUES (2,14);
INSERT INTO  EQUIPO_JUGADORES (ID_EQUIPO,ID_JUGADOR)VALUES (1,15);
INSERT INTO  EQUIPO_JUGADORES (ID_EQUIPO,ID_JUGADOR)VALUES (8,16);
INSERT INTO  EQUIPO_JUGADORES (ID_EQUIPO,ID_JUGADOR)VALUES (3,17);
INSERT INTO  EQUIPO_JUGADORES (ID_EQUIPO,ID_JUGADOR)VALUES (4,18);
INSERT INTO  EQUIPO_JUGADORES (ID_EQUIPO,ID_JUGADOR)VALUES (6,19);
INSERT INTO  EQUIPO_JUGADORES (ID_EQUIPO,ID_JUGADOR)VALUES (7,20);




---TABLA CONVOCATORIA
INSERT INTO CONVOCATORIA (ID_PARTIDO,ID_JUGADOR)VALUES (1,1);
INSERT INTO  CONVOCATORIA (ID_PARTIDO,ID_JUGADOR)VALUES (2,2);
INSERT INTO  CONVOCATORIA (ID_PARTIDO,ID_JUGADOR)VALUES (3,18);
INSERT INTO  CONVOCATORIA (ID_PARTIDO,ID_JUGADOR)VALUES (4,4);
INSERT INTO  CONVOCATORIA (ID_PARTIDO,ID_JUGADOR)VALUES (5,15);
INSERT INTO CONVOCATORIA (ID_PARTIDO,ID_JUGADOR)VALUES (6,9);
INSERT INTO CONVOCATORIA (ID_PARTIDO,ID_JUGADOR)VALUES (7,10);
INSERT INTO  CONVOCATORIA (ID_PARTIDO,ID_JUGADOR)VALUES (8,6);
INSERT INTO  CONVOCATORIA (ID_PARTIDO,ID_JUGADOR)VALUES (9,13);
INSERT INTO  CONVOCATORIA (ID_PARTIDO,ID_JUGADOR)VALUES (10,20);



-----------------CONSULTAS-----------------------------------------------------------------
---MUESTRA LA CANTIDAD DE JUGADORES POR EQUIPO:


SELECT E.NOMBRE_EQUIPO, COUNT(J.ID_JUGADOR) AS CANTIDAD_JUGADORES 
FROM EQUIPOS E 
INNER JOIN EQUIPO_JUGADORES EJ ON E.ID_EQUIPO = EJ.ID_EQUIPO 
INNER JOIN JUGADORES J ON EJ.ID_JUGADOR = J.ID_JUGADOR 
GROUP BY E.NOMBRE_EQUIPO;

---JUGADORES QUE HAN JUGADO MÁS DE UN EQUIPO

SELECT J.NOMBRE, J.APELLIDO1, J.APELLIDO2, COUNT(DISTINCT E.NOMBRE_EQUIPO) AS CANTIDAD_EQUIPOS FROM JUGADORES J
INNER JOIN EQUIPO_JUGADORES EJ ON J.ID_JUGADOR = EJ.ID_JUGADOR 
INNER JOIN EQUIPOS E ON EJ.ID_EQUIPO = E.ID_EQUIPO
GROUP BY J.NOMBRE, J.APELLIDO1, J.APELLIDO2 HAVING COUNT(DISTINCT E.NOMBRE_EQUIPO) > 1;


---PARA OBTENER NOMBRE DE EQUIPO,JUGADOR Y OBTENER LA CANTIDAD DE GOLES POR CADA TEMPORADA

SELECT E.NOMBRE_EQUIPO, J.NOMBRE, SUM(P.GOLES_LOCAL) AS GOLES_ANOTADOS 
FROM EQUIPOS E 
JOIN PARTIDOS P ON E.ID_EQUIPO = P.ID_EQUIPO_LOCAL 
JOIN CONVOCATORIA C ON P.ID_PARTIDO = C.ID_PARTIDO 
JOIN JUGADORES J ON C.ID_JUGADOR = J.ID_JUGADOR 
GROUP BY E.NOMBRE_EQUIPO, J.NOMBRE;


---obtener el nombre del equipo, el nombre del entrenador y la cantidad de partidos dirigidos por cada entrenador en la temporada

SELECT E.NOMBRE_EQUIPO, EN.NOMBRE, COUNT(*) AS TOTAL_PARTIDOS 
FROM EQUIPOS E
JOIN PARTIDOS P ON E.ID_EQUIPO = P.ID_EQUIPO_LOCAL OR E.ID_EQUIPO = P.ID_EQUIPO_VISITA 
JOIN ENTRENADORES EN ON E.ID_ENTRENADOR = EN.ID_ENTRENADOR 
GROUP BY E.NOMBRE_EQUIPO, EN.NOMBRE;

---obtener el nombre del equipo, el nombre del jugador y el precio total de las transferencias para cada jugador
SELECT E.NOMBRE_EQUIPO, J.NOMBRE, SUM(t.TOTAL_TRANSFERENCIA) AS PRECIO_TOTAL 
FROM EQUIPOS E 
JOIN TRANSFERENCIAS T ON E.ID_EQUIPO = T.ID_EQUIPO_NUEVO 
JOIN JUGADORES J ON t.ID_JUGADOR = J.ID_JUGADOR 
GROUP BY E.NOMBRE_EQUIPO, J.NOMBRE;


---obtener información de un partido, incluyendo el nombre del estadio, el árbitro y los equipos participantes
SELECT P.ID_PARTIDO, E1.NOMBRE_EQUIPO AS EQUIPO_LOCAL, P.GOLES_LOCAL, E2.NOMBRE_EQUIPO AS EQUIPO_VISITA, P.GOLES_VISITA, ES.NOMBRE_ESTADIO, A.NOMBRE AS NOMBRE_ARBITRO 
FROM PARTIDOS P 
INNER JOIN EQUIPOS E1 ON P.ID_EQUIPO_LOCAL = E1.ID_EQUIPO 
INNER JOIN EQUIPOS E2 ON P.ID_EQUIPO_VISITA = E2.ID_EQUIPO 
INNER JOIN ESTADIOS ES ON P.ID_ESTADIO = ES.ID_ESTADIO 
INNER JOIN ARBITROS A ON P.ID_ARBITRO = A.ID_ARBITRO 
WHERE P.ID_PARTIDO = 1;

---obtener las transferencias de jugadores con información detallada sobre los equipos involucrados y los montos de transferencia
SELECT J.NOMBRE, J.APELLIDO1, J.APELLIDO2, E_ANT.NOMBRE_EQUIPO AS EQUIPO_ANTERIOR, E_NUEVO.NOMBRE_EQUIPO AS EQUIPO_NUEVO, T.FECHA_TRANSFERENCIA, T.TOTAL_TRANSFERENCIA 
FROM TRANSFERENCIAS T 
INNER JOIN JUGADORES J ON T.ID_JUGADOR = J.ID_JUGADOR 
INNER JOIN EQUIPOS E_ANT ON T.ID_EQUIPO_ANTERIOR = E_ANT.ID_EQUIPO 
INNER JOIN EQUIPOS E_NUEVO ON T.ID_EQUIPO_NUEVO = E_NUEVO.ID_EQUIPO;

---Obtener lista de equipos junto con los nombres de sus jugadores y el nombre del estadio donde juegan
SELECT E.NOMBRE_EQUIPO, J.NOMBRE, J.APELLIDO1, J.APELLIDO2, ES.NOMBRE_ESTADIO 
FROM EQUIPOS E 
INNER JOIN EQUIPO_JUGADORES EJ ON E.ID_EQUIPO = EJ.ID_EQUIPO 
INNER JOIN JUGADORES J ON EJ.ID_JUGADOR = J.ID_JUGADOR 
INNER JOIN ESTADIOS ES ON E.ID_ESTADIO = ES.ID_ESTADIO;

---obtener detalle de los entrenadores de los equipos que pertenecen a una división específica, incluyendo el nombre del equipo
SELECT E.NOMBRE_EQUIPO, EN.NOMBRE, EN.APELLIDO1, EN.APELLIDO2, D.NOMBRE_DIVISION 
FROM EQUIPOS E 
INNER JOIN DIVISIONES D ON E.ID_DIVISION = D.ID_DIVISION 
INNER JOIN ENTRENADORES EN ON E.ID_ENTRENADOR = EN.ID_ENTRENADOR 
WHERE D.ID_DIVISION = 1;

--- Obtener lista de partidos jugados en un estadio específico, mostrando los equipos que jugaron, los goles marcados y el nombre del árbitro
SELECT P.ID_PARTIDO, E1.NOMBRE_EQUIPO AS EQUIPO_LOCAL, P.GOLES_LOCAL, E2.NOMBRE_EQUIPO AS EQUIPO_VISITA, P.GOLES_VISITA, A.NOMBRE AS NOMBRE_ARBITRO, A.APELLIDO1 AS APELLIDO_ARBITRO 
FROM PARTIDOS P 
INNER JOIN EQUIPOS E1 ON P.ID_EQUIPO_LOCAL = E1.ID_EQUIPO 
INNER JOIN EQUIPOS E2 ON P.ID_EQUIPO_VISITA = E2.ID_EQUIPO 
INNER JOIN ARBITROS A ON P.ID_ARBITRO = A.ID_ARBITRO 
WHERE P.ID_ESTADIO = 1

--- ENCONTRAR ARBITROS QUE DIRIGIERON MÁS PARTIDOS Y EN ESE PARTIDO QUE ANOTARON MAS DE 2 GOLES
SELECT AR.NOMBRE, AR.APELLIDO1, AR.APELLIDO2, COUNT(P.ID_PARTIDO) AS NUMERO_PARTIDOS 
FROM ARBITROS AR 
JOIN PARTIDOS P ON AR.ID_ARBITRO = P.ID_ARBITRO 
WHERE (P.GOLES_LOCAL + P.GOLES_VISITA) > 2
GROUP BY AR.NOMBRE, AR.APELLIDO1, AR.APELLIDO2 
HAVING COUNT(P.ID_PARTIDO) >= 1;

---obtener información sobre los jugadores convocados para un partido específico, incluyendo sus nombres y el nombre del equipo
SELECT J.NOMBRE, J.APELLIDO1, J.APELLIDO2, E.NOMBRE_EQUIPO 
FROM CONVOCATORIA C 
INNER JOIN JUGADORES J ON C.ID_JUGADOR = J.ID_JUGADOR 
INNER JOIN PARTIDOS P ON C.ID_PARTIDO = P.ID_PARTIDO 
INNER JOIN EQUIPOS E ON J.ID_JUGADOR = E.ID_EQUIPO 
WHERE P.ID_PARTIDO = 1;

---Obtener detalles de los árbitros que han dirigido partidos de equipos pertenecientes a la segunda division, mostrando el nombre del árbitro
SELECT A.NOMBRE, A.APELLIDO1, A.APELLIDO2, D.NOMBRE_DIVISION 
FROM PARTIDOS P 
INNER JOIN EQUIPOS E ON P.ID_EQUIPO_LOCAL = E.ID_EQUIPO OR P.ID_EQUIPO_VISITA = E.ID_EQUIPO 
INNER JOIN ARBITROS A ON P.ID_ARBITRO = A.ID_ARBITRO 
INNER JOIN DIVISIONES D ON E.ID_DIVISION = D.ID_DIVISION 
WHERE D.ID_DIVISION = 2;

---ENCONTAR EQUIPOS QUE HAN TRANSFERIDO JUGADORES A UNA CANTIDAD DE 400000 MIL Y EL TOTAL DE MONTO TRANSFERIDO
SELECT EQ.NOMBRE_EQUIPO, SUM(TT.TOTAL_TRANSFERENCIA) AS TOTAL_TRANSFERIDO 
FROM EQUIPOS EQ 
JOIN TRANSFERENCIAS TR ON EQ.ID_EQUIPO = TR.ID_EQUIPO_NUEVO 
JOIN TRANSFERENCIAS TT ON EQ.ID_EQUIPO = TT.ID_EQUIPO_ANTERIOR 
GROUP BY EQ.NOMBRE_EQUIPO 
HAVING SUM(TT.TOTAL_TRANSFERENCIA) > 400000;

---CONSULTA PARA ENCONTAR LOS ARBITROS QUE HAN DIRIGIDO PARTIDOS EN ALAJUELA
SELECT AR.NOMBRE, AR.APELLIDO1, AR.APELLIDO2, COUNT(P.ID_PARTIDO) AS NUMERO_PARTIDOS 
FROM ARBITROS AR 
JOIN PARTIDOS P ON AR.ID_ARBITRO = P.ID_ARBITRO 
JOIN ESTADIOS ES ON P.ID_ESTADIO = ES.ID_ESTADIO 
WHERE ES.UBICACION = 'ALAJUELA' 
GROUP BY AR.NOMBRE, AR.APELLIDO1, AR.APELLIDO2;

--- Obtener Transferencias de jugadores con información detallada sobre los equipos involucrados, la nacionalidad del jugador y el monto de transferencia
SELECT J.NOMBRE, J.APELLIDO1, J.APELLIDO2, N.DESCRIPCION AS NACIONALIDAD, E_ANT.NOMBRE_EQUIPO AS EQUIPO_ANTERIOR,  
E_NUEVO.NOMBRE_EQUIPO AS EQUIPO_NUEVO, T.FECHA_TRANSFERENCIA, T.TOTAL_TRANSFERENCIA 
FROM TRANSFERENCIAS T 
INNER JOIN JUGADORES J ON T.ID_JUGADOR = J.ID_JUGADOR 
INNER JOIN EQUIPOS E_ANT ON T.ID_EQUIPO_ANTERIOR = E_ANT.ID_EQUIPO 
INNER JOIN EQUIPOS E_NUEVO ON T.ID_EQUIPO_NUEVO = E_NUEVO.ID_EQUIPO 
INNER JOIN NACIONALIDADES N ON J.ID_NACIONALIDAD = N.ID_NACIONALIDAD;
---CONSULTA PARA ENCONTAR EQUIPOS QUE HAN TRANSFERIDO JUGADORES A UNA CANTIDAD SUPERIOR A LA MEDIA DE TODAS LAS TRANFERENCIAS REALIZADAS
SELECT EQ.NOMBRE_EQUIPO, SUM(T.TOTAL_TRANSFERENCIA) AS TOTAL_TRANSFERIDO 
FROM EQUIPOS EQ 
JOIN TRANSFERENCIAS T ON EQ.ID_EQUIPO = T.ID_EQUIPO_NUEVO 
GROUP BY EQ.NOMBRE_EQUIPO 
HAVING SUM(T.TOTAL_TRANSFERENCIA) > ( 
SELECT AVG(TOTAL_TRANSFERENCIA) 
 FROM TRANSFERENCIAS); 
 
---CONSULTA PARA SABER LOS ARBITOS QUE HAN DIRIGIDO EN UN LUGAR DISTINTO

SELECT A.NOMBRE, A.APELLIDO1, A.APELLIDO2, COUNT(DISTINCT ES.UBICACION) AS NUMERO_CIUDADES_DISTINTAS 
FROM ARBITROS A 
JOIN PARTIDOS P ON A.ID_ARBITRO = P.ID_ARBITRO 
JOIN ESTADIOS ES ON P.ID_ESTADIO = ES.ID_ESTADIO 
GROUP BY A.NOMBRE, A.APELLIDO1, A.APELLIDO2 
HAVING COUNT(DISTINCT ES.UBICACION) >= 1;



---USO DEL DELETE Y EL UPDATE

--CAMBIO DE NOMBRE USANDO EL ID_EQUIPO
UPDATE EQUIPOS
SET NOMBRE_EQUIPO = 'FC SAPRISSA'
WHERE ID_EQUIPO = 1;

--ACTUALIZAR NOMBRE DE UBICACION DE ESTADIOS
UPDATE ESTADIOS
SET UBICACION='SANTODOMINGO'
WHERE ID_ESTADIO=6;

--ACTUALIZAR LA FECHA DE UN JUGADOR POR SU ID Y LA FECHA ANTERIOR
UPDATE TRANSFERENCIAS SET FECHA_TRANSFERENCIA = TO_DATE('17/06/2018', 'DD/MM/YYYY')
WHERE ID_JUGADOR = 1 AND FECHA_TRANSFERENCIA = TO_DATE('14/05/2017', 'DD/MM/YYYY');

--ACTUALIZAR EL EQUIPO VISITANTE DE UN PARTIDO POR SU ID
UPDATE PARTIDOS SET ID_EQUIPO_VISITA = 9 
WHERE ID_PARTIDO = 9;

--ACTUALIZAR EL ESTADIO DE UN PARTIDO POR SU ID
UPDATE PARTIDOS SET ID_ESTADIO = 8 WHERE ID_PARTIDO = 8;


-- ELIMIAR EQUIPO 
DELETE FROM EQUIPOS
WHERE ID_EQUIPO = 1
AND NOT EXISTS (
SELECT 1 
FROM PARTIDOS 
WHERE ID_EQUIPO_LOCAL =2  
OR ID_EQUIPO_VISITA =3
);

--ELiminar registros de EQUIPO_JUGADORES asociados al equipo en cuestión

DELETE FROM EQUIPO_JUGADORES
WHERE ID_EQUIPO = 2;

--ELIMINAR JUGADORES ASOCIADOS AL EQUIPO
DELETE FROM JUGADORES
WHERE ID_JUGADOR IN (
    SELECT ID_JUGADOR
    FROM EQUIPO_JUGADORES
    WHERE ID_EQUIPO = 2
);

--ELIMINAR UNA CONVOCATORIA Y SUS REGISTROS ASOCIADOS
DELETE FROM CONVOCATORIA
WHERE ID_PARTIDO = 2;


---ELIMINAR NACIONALIDADES

DELETE FROM NACIONALIDADES
WHERE ID_NACIONALIDAD =10;


---Eliminar transferencias de jugadores antes de una fecha específica
DELETE FROM TRANSFERENCIAS
WHERE FECHA_TRANSFERENCIA < TO_DATE('2023-01-01', 'YYYY-MM-DD');

